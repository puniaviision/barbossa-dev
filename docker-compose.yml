services:
  barbossa:
    build: .
    container_name: barbossa
    restart: unless-stopped
    volumes:
      # Persist logs and output
      - ./logs:/app/logs
      - ./changelogs:/app/changelogs
      - ./projects:/app/projects
      # Git config for commits
      - ~/.gitconfig:/home/barbossa/.gitconfig
      # GitHub CLI auth (required)
      - ~/.config/gh:/home/barbossa/.config/gh:ro
      # SSH keys (optional - only needed if using git@github.com URLs)
      # - ~/.ssh:/home/barbossa/.ssh:ro
      # Claude config (writable for token refresh)
      - ~/.claude:/home/barbossa/.claude
    environment:
      - GITHUB_TOKEN=${GITHUB_TOKEN}
      - TZ=${TZ:-UTC}
      # Claude API key (for Claude Code CLI)
      - ANTHROPIC_API_KEY=${ANTHROPIC_API_KEY:-}
      # Linear API key (required for Linear integration)
      - LINEAR_API_KEY=${LINEAR_API_KEY:-}
      # Google Analytics 4 (optional - get API secret from GA4 admin)
      - GA4_API_SECRET=${GA4_API_SECRET:-}
      # Set to 'true' to disable analytics
      - BARBOSSA_ANALYTICS_OPT_OUT=${BARBOSSA_ANALYTICS_OPT_OUT:-false}
